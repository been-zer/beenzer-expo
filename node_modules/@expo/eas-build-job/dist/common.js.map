{"version":3,"file":"common.js","sourceRoot":"","sources":["../src/common.ts"],"names":[],"mappings":"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","sourcesContent":["import Joi from 'joi';\n\nimport { BuildPhase, BuildPhaseResult } from './logs';\n\nexport enum BuildMode {\n  BUILD = 'build',\n  RESIGN = 'resign',\n  CUSTOM = 'custom',\n}\n\nexport enum Workflow {\n  GENERIC = 'generic',\n  MANAGED = 'managed',\n  UNKNOWN = 'unknown',\n}\n\nexport enum Platform {\n  ANDROID = 'android',\n  IOS = 'ios',\n}\n\nexport enum ArchiveSourceType {\n  NONE = 'NONE',\n  S3 = 'S3',\n  URL = 'URL',\n  PATH = 'PATH',\n  GCS = 'GCS',\n  GIT = 'GIT',\n}\n\nexport enum BuildTrigger {\n  EAS_CLI = 'EAS_CLI',\n  GIT_BASED_INTEGRATION = 'GIT_BASED_INTEGRATION',\n}\n\nexport type ArchiveSource =\n  | { type: ArchiveSourceType.NONE }\n  | { type: ArchiveSourceType.S3; bucketKey: string }\n  | { type: ArchiveSourceType.GCS; bucketKey: string }\n  | { type: ArchiveSourceType.URL; url: string }\n  | { type: ArchiveSourceType.PATH; path: string }\n  | {\n      type: ArchiveSourceType.GIT;\n      /**\n       * Url that can be used to clone repository.\n       * It should contain embedded credentials for private registries.\n       */\n      repositoryUrl: string;\n      /**\n       * Git commit hash, branch, or tag\n       */\n      gitRef: string;\n    };\n\nexport const ArchiveSourceSchema = Joi.object<ArchiveSource>({\n  type: Joi.string()\n    .valid(...Object.values(ArchiveSourceType))\n    .required(),\n})\n  .when(Joi.object({ type: ArchiveSourceType.GCS }).unknown(), {\n    then: Joi.object({\n      type: Joi.string().valid(ArchiveSourceType.GCS).required(),\n      bucketKey: Joi.string().required(),\n    }),\n  })\n  .when(Joi.object({ type: ArchiveSourceType.S3 }).unknown(), {\n    then: Joi.object({\n      type: Joi.string().valid(ArchiveSourceType.S3).required(),\n      bucketKey: Joi.string().required(),\n    }),\n  })\n  .when(Joi.object({ type: ArchiveSourceType.URL }).unknown(), {\n    then: Joi.object({\n      type: Joi.string().valid(ArchiveSourceType.URL).required(),\n      url: Joi.string().uri().required(),\n    }),\n  })\n  .when(Joi.object({ type: ArchiveSourceType.GIT }).unknown(), {\n    then: Joi.object({\n      type: Joi.string().valid(ArchiveSourceType.GIT).required(),\n      repositoryUrl: Joi.string().required(),\n      gitRef: Joi.string().required(),\n    }),\n  })\n  .when(Joi.object({ type: ArchiveSourceType.PATH }).unknown(), {\n    then: Joi.object({\n      type: Joi.string().valid(ArchiveSourceType.PATH).required(),\n      path: Joi.string().required(),\n    }),\n  });\n\nexport type Env = Record<string, string>;\nexport const EnvSchema = Joi.object().pattern(Joi.string(), Joi.string());\n\nexport type EnvironmentSecret = {\n  name: string;\n  type: EnvironmentSecretType;\n  value: string;\n};\nexport enum EnvironmentSecretType {\n  STRING = 'string',\n  FILE = 'file',\n}\nexport const EnvironmentSecretsSchema = Joi.array().items(\n  Joi.object({\n    name: Joi.string().required(),\n    value: Joi.string().required(),\n    type: Joi.string()\n      .valid(...Object.values(EnvironmentSecretType))\n      .required(),\n  })\n);\n\nexport interface Cache {\n  disabled: boolean;\n  clear: boolean;\n  key?: string;\n  cacheDefaultPaths: boolean;\n  customPaths: string[];\n}\n\nexport const CacheSchema = Joi.object({\n  disabled: Joi.boolean().default(false),\n  clear: Joi.boolean().default(false),\n  key: Joi.string().allow('').max(128),\n  cacheDefaultPaths: Joi.boolean().default(true),\n  customPaths: Joi.array().items(Joi.string()).default([]),\n});\n\nexport interface BuildPhaseStats {\n  buildPhase: BuildPhase;\n  result: BuildPhaseResult;\n  durationMs: number;\n}\n"]}